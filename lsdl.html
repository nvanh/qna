<!DOCTYPE html>
<html lang="vi">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Ôn tập LSDL Lớp 6 - HKI</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=arrow_back" />
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link href="style.css" rel="stylesheet" />
	</head>
	<body>
		<!-- Result Modal -->
		<div class="modal fade" id="resultModal" tabindex="-1" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header bg-primary text-white">
						<h5 class="modal-title" id="resultTitle"></h5>
					</div>
					<div class="modal-body text-center">
						<p id="resultMessage" class="fs-4"></p>
						<div class="d-flex justify-content-center align-items-center gap-3">
							<p>Correct: <span id="resultCorrect" class="stats-correct fw-bold fs-3"></span></p>
							<p>Incorrect: <span id="resultIncorrect" class="stats-incorrect fw-bold fs-3"></span></p>
							<p>Time: <span id="resultTime" class="fw-bold fs-3"></span></p>
						</div>
						<button class="btn btn-lg btn-primary mt-3" onclick="restartQuiz()">Retest</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Main Content -->
		<div class="w-100">
			<div class="header d-flex justify-content-between align-items-center bg-dark text-white w-100">
        <a href="index.html" class="text-decoration-none text-white me-5"><span class="material-symbols-outlined">arrow_back</span></a>
				<div class="d-flex flex-column gap-2">
					<h1 class="text-center m-0">Ôn tập Lịch Sử & Địa Lý Lớp 6 - HKI</h1>
					<div id="timer" class="fs-5 text-center text-warning">Time: 0s</div>
				</div>
				<div id="stats" class="text-end">
					<div>Correct: <span class="stats-correct">0</span></div>
					<div>Incorrect: <span class="stats-incorrect">0</span></div>
				</div>
			</div>
			<div class="play mx-auto">
				<div id="question" class="question-display"></div>
				<div id="options" class="d-flex flex-wrap justify-content-center"></div>
				<div class="text-center">
					<button id="confirmBtn" class="btn btn-success confirm-btn" disabled>Confirm (Phím Space)</button>
				</div>
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			const correctSound = new Audio("correct.mp3");
			const errorSound = new Audio("error.mp3");

			const questions = [
				{
					question: "Câu 1. Than đá, dầu mỏ, khí đốt thuộc nhóm khoáng sản nào?",
					options: ["A. Kim loại đen", "B. Kim loại màu", "C. Năng lượng", "D. Phi kim loại"],
					correct: "C. Năng lượng",
				},
				{
					question: "Câu 2. Trong thành phần không khí, oxy chiếm:",
					options: ["A. 15%", "B. 20%", "C. 21%", "D. 25%"],
					correct: "C. 21%",
				},
				{
					question: "Câu 3. Núi là gì, có đặc điểm:",
					options: ["A. Đỉnh tròn sườn thoải", "B. Đỉnh nhọn sườn thoải", "C. Đỉnh tròn sườn dốc", "D. Đỉnh nhọn sườn dốc"],
					correct: "D. Đỉnh nhọn sườn dốc",
				},
				{
					question: "Câu 4. Cao nguyên rất thuận lợi cho việc:",
					options: ["A. Trồng cây thực phẩm và chăn nuôi gia súc, gia cầm", "B. Trồng cây công nghiệp và cây lương thực", "C. Trồng cây lương thực và chăn nuôi gia súc lớn", "D. Trồng cây công nghiệp và chăn nuôi gia súc lớn"],
					correct: "D. Trồng cây công nghiệp và chăn nuôi gia súc lớn",
				},
				{
					question: "Câu 5. Núi lửa và động đất là những hiện tượng do:",
					options: ["A. Ngoại lực sinh ra", "B. Nội lực sinh ra", "C. Cả nội lực và ngoại lực", "D. Tất cả đều sai"],
					correct: "B. Nội lực sinh ra",
				},
				{
					question: "Câu 6. Tác động của các quá trình nội sinh thường có xu hướng:",
					options: ["A. Làm cho địa hình ghồ ghề", "B. San bằng địa hình", "C. Hạ thấp địa hình", "D. Phá hủy chỗ này bồi đắp chỗ khác"],
					correct: "A. Làm cho địa hình ghồ ghề",
				},
				{
					question: "Câu 7. Dạng địa hình nào sau đây *không* phải hình thành do quá trình ngoại sinh?",
					options: ["A. Mưa lớn gây ra sạt lở đất ở miền núi", "B. Động đất gây ra ở miền núi", "C. Địa hình tích tụ vùng cửa sông", "D. Đầm lầy, ao hồ"],
					correct: "B. Động đất gây ra ở miền núi",
				},
				{
					question: "Câu 8. Ngọn núi có độ cao tường đối là 1000m, người ta đo thấp nhất của chân núi này là mực nước biển trung bình 150m. Vậy độ cao tuyệt đối của ngọn núi này là:",
					options: ["A. 1100m", "B. 1150m", "C. 950m", "D. 1200m"],
					correct: "B. 1150m",
				},
				{
					question: "Câu 9. Độ cao tuyệt đối của núi là khoảng cách đo theo chiều thẳng đứng, từ đỉnh núi đến:",
					options: ["A. Mực nước biển", "B. Chân núi", "C. Đáy đại dương", "D. Chỗ thấp nhất của chân núi"],
					correct: "A. Mực nước biển",
				},
				{
					question: "Câu 10. Bình nguyên thuận lợi cho việc:",
					options: ["A. Trồng cây lương thực và cây công nghiệp lâu năm", "B. Trồng cây thực phẩm và chăn nuôi gia súc lớn", "C. Trồng cây lương thực và thực phẩm", "D. Trồng cây công nghiệp lâu năm và chăn nuôi gia súc lớn"],
					correct: "D. Trồng cây công nghiệp lâu năm và chăn nuôi gia súc lớn",
				},
				{
					question: "Câu 11. Con người đã phát hiện và dùng kim loại để chế tạo công cụ vào khoảng thời gian nào?",
					options: ["A. Thiên niên kỉ II TCN", "B. Thiên niên kỉ III TCN", "C. Thiên niên kỉ IV TCN", "D. Thiên niên kỉ V TCN"],
					correct: "A. Thiên niên kỉ II TCN",
				},
				{
					question: "Câu 12. Kim loại đầu tiên mà người Tây Á và Ai Cập phát hiện ra:",
					options: ["A. Đồng thau", "B. Đồng đỏ", "C. Sắt", "D. Nhôm"],
					correct: "B. Đồng đỏ",
				},
				{
					question: "Câu 13. Ai Cập cổ đại được hình thành ở lưu vực:",
					options: ["A. Sông Nin", "B. Sông Hằng", "C. Sông Ấn", "D. Sông Dương Tử"],
					correct: "A. Sông Nin",
				},
				{
					question: "Câu 14. Đứng đầu giai cấp thống trị ở Ai Cập cổ đại là:",
					options: ["A. Vua chuyên chế (Pha-ra-ông)", "B. Đổng đảo quý tộc quan lại", "C. Quý tộc", "D. Tầng lớp tăng lữ"],
					correct: "A. Vua chuyên chế (Pha-ra-ông)",
				},
				{
					question: "Câu 15. Tại sao nhà nước Ai Cập cổ đại sớm hình thành và phát triển ở lưu vực sông Nin?",
					options: ["A. Do có điều kiện thuận lợi cho người dân sinh sống và sản xuất", "B. Cư dân ở đây sớm phát minh ra công cụ bằng kim loại", "C. Đây vốn là địa bàn cư trú của người nguyên thủy", "D. Do có điều kiện thuận lợi để phát triển hoạt động buôn bán"],
					correct: "A. Do có điều kiện thuận lợi cho người dân sinh sống và sản xuất",
				},
				{
					question: "Câu 16. Văn hóa Ấn Độ được truyền bá và có ảnh hưởng mạnh mẽ, sâu rộng nhất ở đâu?",
					options: ["A. Trung Quốc", "B. Các nước Ả Rập", "C. Các nước Đông Nam Á", "D. Việt Nam"],
					correct: "C. Các nước Đông Nam Á",
				},
				{
					question: "Câu 17. Chế độ phong kiến ở Trung Quốc được hình thành dưới triều đại nào?",
					options: ["A. Nhà Thương", "B. Nhà Chu", "C. Nhà Tần", "D. Nhà Hán"],
					correct: "C. Nhà Tần",
				},
				{
					question: "Câu 18. Ý nào không đúng về các thành phần xã hội thời Tần?",
					options: ["A. Nông dân tự canh", "B. Nông dân tá điền", "C. Nông dân lĩnh canh", "D. Lãnh chúa"],
					correct: "D. Lãnh chúa",
				},
				{
					question: "Câu 19. Con người đã biết chế tác công cụ lao động theo thứ tự:",
					options: ["A. đá -> đồng đỏ -> đồng thau -> sắt", "B. sắt -> đá -> đồng đỏ -> đồng thau", "C. sắt -> đá -> đồng đỏ -> đồng thau", "D. đồng đỏ -> đồng thau -> sắt"],
					correct: "A. đá -> đồng đỏ -> đồng thau -> sắt",
				},
				{
					question: "Câu 20. Công cụ lao động bằng kim loại đã giúp con người nguyên thủy:",
					options: ["A. Thu hẹp diện tích canh tác để làm nhà ở", "B. Sống quây quần gần bờ với nhau", "C. Chống lại các cuộc xung đột từ bên ngoài", "D. Tăng năng suất lao động, tạo ra sản phẩm dư thừa"],
					correct: "D. Tăng năng suất lao động, tạo ra sản phẩm dư thừa",
				},
				{
					question: "Câu 21. Hai con sông gắn liền với sự hình thành nền văn minh Ấn Độ cổ đại?",
					options: ["A. Sông Ấn - Hằng", "B. Sông Ni-giê-rơ và Ô-phơ-rát", "C. Sông Trường Giang - Hoàng Hà", "D. Sông Ô-phơ-rát và Trường Giang"],
					correct: "A. Sông Ấn - Hằng",
				},
				{
					question: "Câu 22. Chữ viết riêng của người Ấn Độ cổ đại là:",
					options: ["A. Chữ Hán", "B. Chữ hình nêm", "C. Chữ Phạn", "D. Chữ Hin-du"],
					correct: "C. Chữ Phạn",
				},
				{
					question: "Câu 23. Đâu là công trình kiến trúc, điêu khắc của Ấn Độ?",
					options: ["A. Nhà hát Ô-đi-ô-ni-xốt", "B. Đại bảo tháp San-chi", "C. Vườn treo Ba-bi-lon", "D. Tượng vệ nữ thành Mi-lô"],
					correct: "B. Đại bảo tháp San-chi",
				},
				{
					question: "Câu 24. Các giai cấp cơ bản của xã hội phong kiến Trung Quốc là",
					options: ["A. Địa chủ, nô lệ", "B. Quí tộc, nông dân", "C. Địa chủ, tá điền", "D. Địa chủ, nông dân lĩnh canh"],
					correct: "D. Địa chủ, nông dân lĩnh canh",
				},
				{
					question: "Câu 25. Công trình phòng ngự nổi tiếng được tiếp tục xây dựng dưới thời nhà Tần có tên gọi là",
					options: ["A. Lăng Ly Trường Thành", "B. Ngọ Môn", "C. Tự Cấm Thành", "D. Lũy Trường Dục"],
					correct: "A. Lăng Ly Trường Thành",
				},
				{
					question: "Câu 26. Cuối thời nguyên thủy, những chuyển biến về kinh tế, xã hội ở Việt Nam gần với các nền văn hóa lứa lật là",
					options: ["A. Đồng Đậu, Phùng Nguyên, Đông Đậu", "B. Đông Đậu, Gò Mun, Phùng Nguyên", "C. Phùng Nguyên, Đông Đậu, Gò Mun", "D. Gò Mun, Đông Đậu, Phùng Nguyên"],
					correct: "C. Phùng Nguyên, Đông Đậu, Gò Mun",
				},
				{
					question: "Câu 27. Trung Quốc thống nhất dưới thời",
					options: ["A. Nhà Tấn", "B. Nhà Đường", "C. Nhà Minh", "D. Nhà Chu"],
					correct: "A. Nhà Tấn",
				},
				{
					question: "Câu 28. Xã hội nguyên thủy tan rã là do",
					options: ["A. Con người liên kết với nhau trong công xã thị tộc", "B. Xã hội phân hóa giàu nghèo", "C. Con người có mối quan hệ bình đẳng", "D. Con người biết chế tạo cung tên"],
					correct: "B. Xã hội phân hóa giàu nghèo",
				},
				{
					question: "Câu 29. Tại sao người Ai Cập giỏi về hình học?",
					options: ["A. Phải đo lại ruộng đất và xây dựng các công trình đền tháp", "B. Phải phân chia ruộng đất cho nông dân", "C. Phải xây dựng các công trình kiến trúc", "D. Phải xây dựng các công trình thủy lợi"],
					correct: "A. Phải đo lại ruộng đất và xây dựng các công trình đền tháp",
				},
				{
					question: "Câu 30. Thành tựu nào sau đây của người Ai Cập cổ đại còn sử dụng đến ngày nay?",
					options: ["A. Chữ tượng hình", "B. Hệ đếm thập phân", "C. Hệ đếm 60", "D. Thuật ướp xác"],
					correct: "B. Hệ đếm thập phân",
				},
			];

			let currentQuestionIndex = 0;
			let correctCount = 0;
			let incorrectCount = 0;
			let selectedOption = null;
			let timerInterval = null;
			let secondsElapsed = 0;
			let shuffledQuestions = [];

			const resultModal = new bootstrap.Modal(document.getElementById("resultModal"));

			function shuffleArray(array) {
				for (let i = array.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[array[i], array[j]] = [array[j], array[i]];
				}
				return array;
			}

			function startQuiz() {
				currentQuestionIndex = 0;
				correctCount = 0;
				incorrectCount = 0;
				shuffledQuestions = shuffleArray([...questions]);
				secondsElapsed = 0;

				updateStats();
				loadQuestion();
				startTimer();
			}

			function startTimer() {
				if (timerInterval) clearInterval(timerInterval);
				secondsElapsed = 0;
				document.getElementById("timer").textContent = `Time: ${secondsElapsed}s`;
				timerInterval = setInterval(() => {
					secondsElapsed++;
					document.getElementById("timer").textContent = `Time: ${secondsElapsed}s`;
				}, 1000);
			}

			function updateStats() {
				document.querySelector("#stats .stats-correct").textContent = correctCount;
				document.querySelector("#stats .stats-incorrect").textContent = incorrectCount;
			}

			function loadQuestion() {
				if (currentQuestionIndex >= shuffledQuestions.length) {
					showResult();
					return;
				}

				const q = shuffledQuestions[currentQuestionIndex];
				const questionElement = document.getElementById("question");
				let formattedQuestion = q.question.replace(/\*([^*]+)\*/g, '<span class="text-primary fw-bold">$1</span>');
				questionElement.innerHTML = formattedQuestion;

				const playArea = document.querySelector(".play");
				let imageContainer = playArea.querySelector("#questionImageContainer");

				if (q.image) {
					if (!imageContainer) {
						imageContainer = document.createElement("div");
						imageContainer.id = "questionImageContainer";
						imageContainer.className = "text-center mb-4";
						const img = document.createElement("img");
						img.id = "questionImage";
						img.className = "img-fluid";
						img.style.maxHeight = "400px";
						img.alt = "Hình minh họa câu hỏi";
						imageContainer.appendChild(img);
						// Chèn ngay sau phần câu hỏi
						document.getElementById("question").after(imageContainer);
					}
					document.getElementById("questionImage").src = q.image;
					imageContainer.style.display = "block";
				} else {
					if (imageContainer) {
						imageContainer.style.display = "none";
					}
				}

				const optionsContainer = document.getElementById("options");
				const confirmBtn = document.getElementById("confirmBtn");
				confirmBtn.disabled = true;
				selectedOption = null;

				const shuffledOptions = shuffleArray([...q.options]);

				optionsContainer.innerHTML = "";

				shuffledOptions.forEach((option) => {
					const div = document.createElement("div");
					div.className = "option-pill";
					div.textContent = option;
					div.onclick = () => selectOption(div, option);
					optionsContainer.appendChild(div);
				});
			}

			function selectOption(element, option) {
				document.querySelectorAll(".option-pill").forEach((pill) => pill.classList.remove("selected"));
				element.classList.add("selected");
				selectedOption = option;
				document.getElementById("confirmBtn").disabled = false;
			}

			function checkAnswer() {
				const q = shuffledQuestions[currentQuestionIndex];
				const isCorrect = selectedOption === q.correct;
				const selectedPill = Array.from(document.querySelectorAll(".option-pill")).find((pill) => pill.textContent === selectedOption);

				if (isCorrect) {
					correctCount++;
					selectedPill.classList.add("correct");
					correctSound.play().catch((e) => console.log("Không phát được âm thanh Correct:", e));
				} else {
					incorrectCount++;
					selectedPill.classList.add("incorrect");
					const correctPill = Array.from(document.querySelectorAll(".option-pill")).find((pill) => pill.textContent === q.correct);
					if (correctPill) correctPill.classList.add("correct");
					errorSound.play().catch((e) => console.log("Không phát được âm thanh Incorrect:", e));
				}
				updateStats();

				setTimeout(() => {
					currentQuestionIndex++;
					loadQuestion();
				}, 1000);
			}

			function showResult() {
				clearInterval(timerInterval);
				document.getElementById("resultCorrect").textContent = correctCount;
				document.getElementById("resultIncorrect").textContent = incorrectCount;
				document.getElementById("resultTime").textContent = `${secondsElapsed}s`;

				if (correctCount === shuffledQuestions.length) {
					document.getElementById("resultTitle").textContent = "Excellent!";
					document.getElementById("resultMessage").textContent = "You achieved 100% accuracy.";
				} else {
					document.getElementById("resultTitle").textContent = "Finished!";
					document.getElementById("resultMessage").textContent = `You answered ${correctCount} out of ${shuffledQuestions.length} questions correctly. Give it another shot!`;
				}
				resultModal.show();
			}

			function restartQuiz() {
				resultModal.hide();
				startQuiz();
			}

			document.getElementById("confirmBtn").onclick = checkAnswer;
			document.addEventListener("keydown", (e) => {
				if (e.code === "Space" && !document.getElementById("confirmBtn").disabled) {
					e.preventDefault();
					checkAnswer();
				}
			});

			document.addEventListener("DOMContentLoaded", () => {
				startQuiz();
			});
		</script>
	</body>
</html>
