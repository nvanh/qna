<!DOCTYPE html>
<html lang="vi">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Ôn tập GDDP Lớp 6 - HKI</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=arrow_back" />
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link href="style.css" rel="stylesheet" />
	</head>
	<body>
		<!-- Result Modal -->
		<div class="modal fade" id="resultModal" tabindex="-1" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header bg-primary text-white">
						<h5 class="modal-title" id="resultTitle"></h5>
					</div>
					<div class="modal-body text-center">
						<p id="resultMessage" class="fs-4"></p>
						<div class="d-flex justify-content-center align-items-center gap-3">
							<p>Correct: <span id="resultCorrect" class="stats-correct fw-bold fs-3"></span></p>
							<p>Incorrect: <span id="resultIncorrect" class="stats-incorrect fw-bold fs-3"></span></p>
							<p>Time: <span id="resultTime" class="fw-bold fs-3"></span></p>
						</div>
						<button class="btn btn-lg btn-primary mt-3" onclick="restartQuiz()">Retest</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Main Content -->
		<div class="w-100">
			<div class="header d-flex justify-content-center align-items-center bg-dark text-white w-100">
				<a href="index.html" class="text-decoration-none text-white me-5"><span class="material-symbols-outlined">arrow_back</span></a>
				<div id="timer" class="fs-5 justify-self-start">Time: 0s</div>
				<h1 class="text-center m-0">Ôn tập Giáo Dục Địa Phương Lớp 6 - HKI</h1>
				<div id="stats" class="text-end">
					<div>Correct: <span class="stats-correct">0</span></div>
					<div>Incorrect: <span class="stats-incorrect">0</span></div>
				</div>
			</div>
			<div class="play mx-auto">
				<div id="question" class="question-display"></div>
				<div id="options" class="d-flex flex-wrap justify-content-center"></div>
				<div class="text-center">
					<button id="confirmBtn" class="btn btn-success confirm-btn" disabled>Confirm (Phím Space)</button>
				</div>
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			const correctSound = new Audio("correct.mp3");
			const errorSound = new Audio("error.mp3");

			const questions = [
				{
					question: "Câu 1. Biểu hiện nào là biểu hiện của gia đình văn hóa?",
					options: ["A. Bố mẹ yêu thương con cái", "B. Con cái đánh bố mẹ", "C. Thường xuyên cãi nhau với hàng xóm láng giềng", "D. Không tham gia các hoạt động tập thể tại địa phương"],
					correct: "A. Bố mẹ yêu thương con cái",
				},
				{
					question: "Câu 2. Góp phần xây dựng gia đình văn hóa học sinh cần phải làm gì?",
					options: ["A. Chăm ngoan, học giỏi", "B. Kính trọng, giúp đỡ ông bà", "C. Không ganh đua, đố kị", "D. Cả A, B, C"],
					correct: "D. Cả A, B, C",
				},
				{
					question: "Câu 3. Câu nói “Gia đình là tế bào của xã hội” nói về điều gì?",
					options: ["A. Vai trò quan trọng của gia đình đối với xã hội", "B. Tính chất của gia đình", "C. Mục đích của gia đình", "D. Đặc điểm của gia đình"],
					correct: "A. Vai trò quan trọng của gia đình đối với xã hội",
				},
				{
					question: "Câu 4. Gia đình hòa thuận, hạnh phúc, tiến bộ, thực hiện kế hoạch hóa gia đình, đoàn kết với xóm giềng và làm tốt nghĩa vụ công dân được gọi là:",
					options: ["A. Gia đình đoàn kết", "B. Gia đình văn hóa", "C. Gia đình vui vẻ", "D. Gia đình hạnh phúc"],
					correct: "B. Gia đình văn hóa",
				},
				{
					question: "Câu 5. Hành vi nào không đúng khi xây dựng gia đình văn hóa?",
					options: [
						"A. Ông B dạy dỗ các con luôn sống yêu thương giúp đỡ mọi người, không làm những việc sai trái",
						"B. Gia đình ông B luôn giúp đỡ mọi người lúc khó khăn",
						"C. Là chủ tịch xã ông H luôn bao che cho con mình để đạt gia đình văn hóa",
						"D. Ông H luôn chăm lo cho gia đình chu đáo, với mọi người ông có thái độ hòa nhã",
					],
					correct: "C. Là chủ tịch xã ông H luôn bao che cho con mình để đạt gia đình văn hóa",
				},
				{
					question: "Câu 6. Để xây dựng gia đình văn hóa mỗi người trong gia đình cần phải làm gì?",
					options: ["A. Tham gia gây rối trật tự khu phố", "B. Tụ tập đánh bạc", "C. Sống có trách nhiệm với gia đình", "D. Tổ chức đua xe"],
					correct: "C. Sống có trách nhiệm với gia đình",
				},
				{
					question: "Câu 7. Diện tích tự nhiên toàn thành phố Hà Nội là:",
					options: ["A. $1234,5\text{ km}^2$", "B. $2234,5\text{ km}^2$", "C. $3358,6\text{ km}^2$", "D. $6321,3\text{ km}^2$"],
					correct: "C. $3358,6\text{ km}^2$",
				},
				{
					question: "Câu 8. Hà Nội tiếp giáp với:",
					options: ["A. 6 tỉnh", "B. 8 tỉnh", "C. 10 tỉnh", "D. 12 tỉnh"],
					correct: "B. 8 tỉnh",
				},
				{
					question: "Câu 9. Hà Nội có bao nhiêu đơn vị hành chính?",
					options: ["A. 10", "B. 20", "C. 30", "D. 40"],
					correct: "C. 30",
				},
				{
					question: "Câu 10. Hà Nội nằm ở vùng nào của Việt Nam?",
					options: ["A. Trung du miền núi Bắc Bộ", "B. Đồng bằng sông Cửu Long", "C. Đồng bằng sông Hồng", "D. Bắc Trung Bộ"],
					correct: "C. Đồng bằng sông Hồng",
				},
				{
					question: "Câu 11. Hà Nội tiếp giáp tỉnh nào ở phía Tây?",
					options: ["A. Bắc Giang", "B. Vĩnh Phúc", "C. Hòa Bình", "D. Hải Dương"],
					correct: "C. Hòa Bình",
				},
				{
					question: "Câu 12. Hà Nội mở rộng địa giới hành chính vào năm nào?",
					options: ["A. 1995", "B. 2008", "C. 2015", "D. 2020"],
					correct: "B. 2008",
				},
				{
					question: "Câu 13. Tỉnh nào được sáp nhập vào Hà Nội năm 2008?",
					options: ["A. Bắc Ninh", "B. Hòa Bình", "C. Hà Tây", "D. Phú Thọ"],
					correct: "C. Hà Tây",
				},
				{
					question: "Câu 14. Việc sáp nhập Hà Tây vào Hà Nội nhằm:",
					options: ["A. Tăng diện tích để quản lý khó hơn", "B. Thuận lợi quy hoạch phát triển Thủ đô", "C. Chỉ để tăng dân số", "D. Phát triển nông nghiệp"],
					correct: "B. Thuận lợi quy hoạch phát triển Thủ đô",
				},
				{
					question: "Câu 15. Học sinh Hà Nội giữ nếp sống thanh lịch bằng cách:",
					options: ["A. Nói năng thô lỗ", "B. Chen lấn nơi công cộng", "C. Nói lời hay, cư xử lịch sự", "D. Không quan tâm đến người khác"],
					correct: "C. Nói lời hay, cư xử lịch sự",
				},
				{
					question: "Câu 16. Ứng xử văn minh trên mạng xã hội là:",
					options: ["A. Gửi tin độc hại", "B. Chia sẻ thông tin sai lệch", "C. Giữ thái độ tôn trọng, kiểm chứng thông tin", "D. Gây tranh cãi vô nghĩa"],
					correct: "C. Giữ thái độ tôn trọng, kiểm chứng thông tin",
				},
				{
					question: "Câu 17. Bố mẹ khi ông bà cần giúp?",
					options: ["A. Hỏi han, phụ giúp việc nhỏ", "B. Chỉ khi được yêu cầu mới giúp", "C. Không giao tiếp với ông bà", "D. Để được bạn ngưỡng mộ"],
					correct: "A. Hỏi han, phụ giúp việc nhỏ",
				},
				{
					question: "Câu 18. Tham gia hoạt động cộng đồng giúp học sinh:",
					options: ["A. Tăng tinh thần trách nhiệm", "B. Nối với bạn bè", "C. Để được giáo viên khen", "D. Không có lợi ích gì"],
					correct: "A. Tăng tinh thần trách nhiệm",
				},
				{
					question: "Câu 19. Học sinh chấp hành luật giao thông vì:",
					options: ["A. Bị phạt tiền", "B. Góp phần giữ nếp sống văn hóa đô thị"],
					correct: "B. Góp phần giữ nếp sống văn hóa đô thị",
				},
				{
					question: "Câu 20. “Gia đình văn hóa” là gia đình như thế nào?",
					options: ["A. Giàu có và đông thành viên", "B. Sống hòa thuận, thực hiện tốt chủ trương chính sách", "C. Có nhà to, đầy đủ tiện nghi", "D. Luôn đạt danh hiệu thi đua"],
					correct: "B. Sống hòa thuận, thực hiện tốt chủ trương chính sách",
				},
			];

			let currentQuestionIndex = 0;
			let correctCount = 0;
			let incorrectCount = 0;
			let selectedOption = null;
			let timerInterval = null;
			let secondsElapsed = 0;
			let shuffledQuestions = [];

			const resultModal = new bootstrap.Modal(document.getElementById("resultModal"));

			function shuffleArray(array) {
				for (let i = array.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[array[i], array[j]] = [array[j], array[i]];
				}
				return array;
			}

			function startQuiz() {
				currentQuestionIndex = 0;
				correctCount = 0;
				incorrectCount = 0;
				shuffledQuestions = shuffleArray([...questions]);
				secondsElapsed = 0;

				updateStats();
				loadQuestion();
				startTimer();
			}

			function startTimer() {
				if (timerInterval) clearInterval(timerInterval);
				secondsElapsed = 0;
				document.getElementById("timer").textContent = `Time: ${secondsElapsed}s`;
				timerInterval = setInterval(() => {
					secondsElapsed++;
					document.getElementById("timer").textContent = `Time: ${secondsElapsed}s`;
				}, 1000);
			}

			function updateStats() {
				document.querySelector("#stats .stats-correct").textContent = correctCount;
				document.querySelector("#stats .stats-incorrect").textContent = incorrectCount;
			}

			function loadQuestion() {
				if (currentQuestionIndex >= shuffledQuestions.length) {
					showResult();
					return;
				}

				const q = shuffledQuestions[currentQuestionIndex];
				const questionElement = document.getElementById("question");
				let formattedQuestion = q.question.replace(/\*([^*]+)\*/g, '<span class="text-primary fw-bold">$1</span>');
				questionElement.innerHTML = formattedQuestion;

				const playArea = document.querySelector(".play");
				let imageContainer = playArea.querySelector("#questionImageContainer");

				if (q.image) {
					if (!imageContainer) {
						imageContainer = document.createElement("div");
						imageContainer.id = "questionImageContainer";
						imageContainer.className = "text-center mb-4";
						const img = document.createElement("img");
						img.id = "questionImage";
						img.className = "img-fluid";
						img.style.maxHeight = "400px";
						img.alt = "Hình minh họa câu hỏi";
						imageContainer.appendChild(img);
						// Chèn ngay sau phần câu hỏi
						document.getElementById("question").after(imageContainer);
					}
					document.getElementById("questionImage").src = q.image;
					imageContainer.style.display = "block";
				} else {
					if (imageContainer) {
						imageContainer.style.display = "none";
					}
				}

				const optionsContainer = document.getElementById("options");
				const confirmBtn = document.getElementById("confirmBtn");
				confirmBtn.disabled = true;
				selectedOption = null;

				const shuffledOptions = shuffleArray([...q.options]);

				optionsContainer.innerHTML = "";

				shuffledOptions.forEach((option) => {
					const div = document.createElement("div");
					div.className = "option-pill";
					div.textContent = option;
					div.onclick = () => selectOption(div, option);
					optionsContainer.appendChild(div);
				});
			}

			function selectOption(element, option) {
				document.querySelectorAll(".option-pill").forEach((pill) => pill.classList.remove("selected"));
				element.classList.add("selected");
				selectedOption = option;
				document.getElementById("confirmBtn").disabled = false;
			}

			function checkAnswer() {
				const q = shuffledQuestions[currentQuestionIndex];
				const isCorrect = selectedOption === q.correct;
				const selectedPill = Array.from(document.querySelectorAll(".option-pill")).find((pill) => pill.textContent === selectedOption);

				if (isCorrect) {
					correctCount++;
					selectedPill.classList.add("correct");
					correctSound.play().catch((e) => console.log("Không phát được âm thanh Correct:", e));
				} else {
					incorrectCount++;
					selectedPill.classList.add("incorrect");
					const correctPill = Array.from(document.querySelectorAll(".option-pill")).find((pill) => pill.textContent === q.correct);
					if (correctPill) correctPill.classList.add("correct");
					errorSound.play().catch((e) => console.log("Không phát được âm thanh Incorrect:", e));
				}
				updateStats();

				setTimeout(() => {
					currentQuestionIndex++;
					loadQuestion();
				}, 1000);
			}

			function showResult() {
				clearInterval(timerInterval);
				document.getElementById("resultCorrect").textContent = correctCount;
				document.getElementById("resultIncorrect").textContent = incorrectCount;
				document.getElementById("resultTime").textContent = `${secondsElapsed}s`;

				if (correctCount === shuffledQuestions.length) {
					document.getElementById("resultTitle").textContent = "Excellent!";
					document.getElementById("resultMessage").textContent = "You achieved 100% accuracy.";
				} else {
					document.getElementById("resultTitle").textContent = "Finished!";
					document.getElementById("resultMessage").textContent = `You answered ${correctCount} out of ${shuffledQuestions.length} questions correctly. Give it another shot!`;
				}
				resultModal.show();
			}

			function restartQuiz() {
				resultModal.hide();
				startQuiz();
			}

			document.getElementById("confirmBtn").onclick = checkAnswer;
			document.addEventListener("keydown", (e) => {
				if (e.code === "Space" && !document.getElementById("confirmBtn").disabled) {
					e.preventDefault();
					checkAnswer();
				}
			});

			document.addEventListener("DOMContentLoaded", () => {
				startQuiz();
			});
		</script>
	</body>
</html>
